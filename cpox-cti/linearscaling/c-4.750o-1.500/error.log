[NbConvertApp] Converting notebook copyme.ipynb to notebook
[NbConvertApp] Executing notebook with kernel: python2
[IPKernelApp] ERROR | Failed to create history session in /home/mazeau.e/.ipython/profile_default/history.sqlite. History will not be saved.
Traceback (most recent call last):
  File "/home/mazeau.e/anaconda2/envs/rmg_env3/lib/python2.7/site-packages/IPython/core/history.py", line 549, in __init__
    self.new_session()
  File "<decorator-gen-22>", line 2, in new_session
  File "/home/mazeau.e/anaconda2/envs/rmg_env3/lib/python2.7/site-packages/IPython/core/history.py", line 60, in needs_sqlite
    return f(self, *a, **kw)
  File "/home/mazeau.e/anaconda2/envs/rmg_env3/lib/python2.7/site-packages/IPython/core/history.py", line 576, in new_session
    self.session_number = cur.lastrowid
OperationalError: database is locked
[NbConvertApp] ERROR | Error while converting 'copyme.ipynb'
Traceback (most recent call last):
  File "/home/mazeau.e/anaconda2/envs/rmg_env3/lib/python2.7/site-packages/nbconvert/nbconvertapp.py", line 393, in export_single_notebook
    output, resources = self.exporter.from_filename(notebook_filename, resources=resources)
  File "/home/mazeau.e/anaconda2/envs/rmg_env3/lib/python2.7/site-packages/nbconvert/exporters/exporter.py", line 174, in from_filename
    return self.from_file(f, resources=resources, **kw)
  File "/home/mazeau.e/anaconda2/envs/rmg_env3/lib/python2.7/site-packages/nbconvert/exporters/exporter.py", line 192, in from_file
    return self.from_notebook_node(nbformat.read(file_stream, as_version=4), resources=resources, **kw)
  File "/home/mazeau.e/anaconda2/envs/rmg_env3/lib/python2.7/site-packages/nbconvert/exporters/notebook.py", line 31, in from_notebook_node
    nb_copy, resources = super(NotebookExporter, self).from_notebook_node(nb, resources, **kw)
  File "/home/mazeau.e/anaconda2/envs/rmg_env3/lib/python2.7/site-packages/nbconvert/exporters/exporter.py", line 134, in from_notebook_node
    nb_copy, resources = self._preprocess(nb_copy, resources)
  File "/home/mazeau.e/anaconda2/envs/rmg_env3/lib/python2.7/site-packages/nbconvert/exporters/exporter.py", line 311, in _preprocess
    nbc, resc = preprocessor(nbc, resc)
  File "/home/mazeau.e/anaconda2/envs/rmg_env3/lib/python2.7/site-packages/nbconvert/preprocessors/base.py", line 47, in __call__
    return self.preprocess(nb, resources)
  File "/home/mazeau.e/anaconda2/envs/rmg_env3/lib/python2.7/site-packages/nbconvert/preprocessors/execute.py", line 262, in preprocess
    nb, resources = super(ExecutePreprocessor, self).preprocess(nb, resources)
  File "/home/mazeau.e/anaconda2/envs/rmg_env3/lib/python2.7/site-packages/nbconvert/preprocessors/base.py", line 69, in preprocess
    nb.cells[index], resources = self.preprocess_cell(cell, resources, index)
  File "/home/mazeau.e/anaconda2/envs/rmg_env3/lib/python2.7/site-packages/nbconvert/preprocessors/execute.py", line 286, in preprocess_cell
    raise CellExecutionError.from_cell_and_msg(cell, out)
CellExecutionError: An error occurred while executing the following cell:
------------------
#######################################################################
# Input Parameters
#######################################################################

volume = 1.0
cat_area_per_vol = 1.0E2 #I made this up!

cat_area = cat_area_per_vol * volume

#initial conditions
T0 = 1000.
P0 = 1.0 #bar
#initial composition (gas mol fraction)
CH4_0 = 0.1
O2_0 = 0.1
N2_0 = 0.8
CO2_0 = 0.

gas.TPX = T0, P0 * ct.one_atm, {'CH4(2)':CH4_0, 'O2(3)':O2_0, 'N2':N2_0, 'CO2(4)':CO2_0}
          #Temp, Pressure, mole fraction
surf.TP = T0, P0 * ct.one_atm
surf.coverages = {'X(1)':1.0}
#surf.coverages = {'PT(S)':0.9, 'O(S)':0.1}

r = ct.IdealGasConstPressureReactor(gas, energy='off')
r.volume = volume
rsurf = ct.ReactorSurface(surf, r, A=cat_area) # A=cat_area

sim = ct.ReactorNet([r])
sim.max_err_test_fails = 12

# set relative and absolute tolerances on the simulation
sim.rtol = 1.0e-12
sim.atol = 1.0e-18

#rxn_time = np.linspace(1E-12, 5, 10001) #
rxn_time = np.logspace(-11, 3, 10001) #from 0s to 1000s, log spacing

gas_mole_fracs = np.zeros([gas.n_species, len(rxn_time)])
surf_site_fracs = np.zeros([surf.n_species, len(rxn_time)])
temperature = np.zeros(len(rxn_time))    
pressure = np.zeros(len(rxn_time))   

for i in range(len(rxn_time)):
    time = rxn_time[i] #define time in the reactor
    sim.advance(time) #Advance the simulation to next set time
    temperature[i] = gas.T
    pressure[i] = gas.P/ct.one_atm
    gas_mole_fracs[:,i] = gas.X #
    surf_site_fracs[:,i] = surf.coverages #
    if not i % 500:
        print('  {0:10e}  {1:10f}  {2:10f}  {3:10f}'.format(time, *gas['CH4(2)','O2(3)','N2'].X))



#sim.advance_to_steady_state()
#print('  {0:10e}  {1:10f}  {2:10f}  {3:10f}'.format(sim.time, *gas['CH4','H2','CO'].X))    
    
# CH4_ref = gas_mole_fracs[i_ch4,:]

# setting new sensitivity to be based on time to consume 95% of the o2
zipped = zip(gas_mole_fracs[i_o2,:],rxn_time)
zipped = [list(z) for z in zipped]
for z in zipped:
    if z[0] <= O2_0 * .05:
        O2_ref_time = z[1]
        break

#Plot out simulations results
fig = pylab.figure(dpi=300,figsize=(8,8))
gs = gridspec.GridSpec(2, 1)
ax0 = plt.subplot(gs[0])
ax1 = plt.subplot(gs[1])

y_min = 1E-3

for i in range(gas.n_species):
    if i != i_n2:
        if np.max(gas_mole_fracs[i,:]) > y_min:
            ax0.loglog(rxn_time, gas_mole_fracs[i,:], label=gas.species_name(i) )

for i in range(surf.n_species):
    if np.max(surf_site_fracs[i,:]) > y_min:
        ax1.loglog(rxn_time, surf_site_fracs[i,:], label=surf.species_name(i) )
            
ax0.legend(loc='lower left', fontsize = 12)
ax1.legend(loc='lower left', fontsize = 12)

ax0.set_ylabel("gas-phase mole fraction")
ax0.set_ylim(y_min,0.5)
ax0.set_xlim(1.0E-4,max(rxn_time))
ax1.set_xlim(1.0E-4,max(rxn_time))
ax0.set_xlabel("Time(s)")
ax1.set_ylabel("surface site fraction")
#ax0.xaxis.set_major_locator(MaxNLocator(6))
#ax0.yaxis.set_major_locator(LogLocator(base=10.0, numticks=3))
#ax0.tick_params(axis='both', which='major', labelsize=10)
ax1.set_ylim(y_min, 1.1 )
ax1.set_xlabel("Time(s)")


#######################
##   FLUX DIAGRAMS   ##
#######################
steps = len(temperature)
for i in range(0, steps, steps//20):
    gas.TP = temperature[i], pressure[i] * ct.one_atm
    gas.X  = gas_mole_fracs[:,i]
    surf.TP = temperature[i], pressure[i] * ct.one_atm
    surf.coverages = surf_site_fracs[:,i]
    
    element = 'O'

    diagram = ct.ReactionPathDiagram(surf, element)
    diagram.title = 'Reaction path diagram following {0}'.format(element)
    diagram.label_threshold = 0.000001

    dot_file = 'rxnpathO{:06d}.dot'.format(i)
    img_file = 'rxnpathO{:06d}.png'.format(i)
    img_path = os.path.join(os.getcwd(), img_file)

    diagram.write_dot(dot_file)
#     print(diagram.get_data())

    print("Wrote graphviz input file to '{0}'.".format(os.path.join(os.getcwd(), dot_file)))

    os.system('dot {0} -Tpng -o{1} -Gdpi=200'.format(dot_file, img_file))
    print("Wrote graphviz output file to '{0}'.".format(img_path))

    from IPython.display import Image
    Image(filename=img_file) 
    
for i in range(0, steps, steps//20):
    gas.TP = temperature[i], pressure[i] * ct.one_atm
    gas.X  = gas_mole_fracs[:,i]
    surf.TP = temperature[i], pressure[i] * ct.one_atm
    surf.coverages = surf_site_fracs[:,i]
    
    element = 'C'

    diagram = ct.ReactionPathDiagram(surf, element)
    diagram.title = 'Reaction path diagram following {0}'.format(element)
    diagram.label_threshold = 0.000001

    dot_file = 'rxnpathC{:06d}.dot'.format(i)
    img_file = 'rxnpathC{:06d}.png'.format(i)
    img_path = os.path.join(os.getcwd(), img_file)

    diagram.write_dot(dot_file)
#     print(diagram.get_data())

    print("Wrote graphviz input file to '{0}'.".format(os.path.join(os.getcwd(), dot_file)))

    os.system('dot {0} -Tpng -o{1} -Gdpi=200'.format(dot_file, img_file))
    print("Wrote graphviz output file to '{0}'.".format(img_path))

    from IPython.display import Image
    Image(filename=img_file) 

------------------

[0;31m[0m
[0;31mCanteraError[0mTraceback (most recent call last)
[0;32m<ipython-input-2-1623b139abe8>[0m in [0;36m<module>[0;34m()[0m
[1;32m     44[0m [0;32mfor[0m [0mi[0m [0;32min[0m [0mrange[0m[0;34m([0m[0mlen[0m[0;34m([0m[0mrxn_time[0m[0;34m)[0m[0;34m)[0m[0;34m:[0m[0;34m[0m[0m
[1;32m     45[0m     [0mtime[0m [0;34m=[0m [0mrxn_time[0m[0;34m[[0m[0mi[0m[0;34m][0m [0;31m#define time in the reactor[0m[0;34m[0m[0m
[0;32m---> 46[0;31m     [0msim[0m[0;34m.[0m[0madvance[0m[0;34m([0m[0mtime[0m[0;34m)[0m [0;31m#Advance the simulation to next set time[0m[0;34m[0m[0m
[0m[1;32m     47[0m     [0mtemperature[0m[0;34m[[0m[0mi[0m[0;34m][0m [0;34m=[0m [0mgas[0m[0;34m.[0m[0mT[0m[0;34m[0m[0m
[1;32m     48[0m     [0mpressure[0m[0;34m[[0m[0mi[0m[0;34m][0m [0;34m=[0m [0mgas[0m[0;34m.[0m[0mP[0m[0;34m/[0m[0mct[0m[0;34m.[0m[0mone_atm[0m[0;34m[0m[0m

[0;32minterfaces/cython/cantera/reactor.pyx[0m in [0;36mcantera._cantera.ReactorNet.advance (interfaces/cython/cantera/_cantera.cpp:65416)[0;34m()[0m

[0;31mCanteraError[0m: 
***********************************************************************
CanteraError thrown by CVodesIntegrator::integrate:
CVodes error encountered. Error code: -4
At t = 23.396 and h = 3.3661e-13, the corrector convergence test failed repeatedly or with |h| = hmin.

Components with largest weighted error estimates:
39: -523976
37: 41555.5
30: 74.87
44: -2.82242
8: 1.18286
38: -0.326041
49: -0.00602442
32: -0.00125852
29: -0.000880615
31: -0.000569954
***********************************************************************

CanteraError: 
***********************************************************************
CanteraError thrown by CVodesIntegrator::integrate:
CVodes error encountered. Error code: -4
At t = 23.396 and h = 3.3661e-13, the corrector convergence test failed repeatedly or with |h| = hmin.

Components with largest weighted error estimates:
39: -523976
37: 41555.5
30: 74.87
44: -2.82242
8: 1.18286
38: -0.326041
49: -0.00602442
32: -0.00125852
29: -0.000880615
31: -0.000569954
***********************************************************************


